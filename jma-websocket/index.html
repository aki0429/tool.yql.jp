<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JMAãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æƒ…å ±API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #f8f9fa;
            --text-color: #34495e;
            --heading-color: #2c3e50;
            --border-color: #e9ecef;
            --code-bg-color: #2d2d2d;
            --code-text-color: #f8f8f2;
            --table-header-bg: #e9ecef;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.7;
            color: var(--text-color);
            margin: 0;
            background-color: #fff;
        }
        .container {
            max-width: 960px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 40px 20px;
            text-align: center;
        }
        header h1 {
            margin: 0;
            font-size: 2.2em;
        }
        main section {
            padding: 25px 0;
            border-bottom: 1px solid var(--border-color);
        }
        main section:last-child {
            border-bottom: none;
        }
        h2 {
            font-size: 1.8em;
            color: var(--heading-color);
            margin-top: 0;
            padding-bottom: 10px;
        }
        code {
            font-family: "SF Mono", "Consolas", "Menlo", monospace;
            background-color: #e9ecef;
            border: 1px solid #dee2e6;
            color: #495057;
            padding: 0.2em 0.4em;
            border-radius: 4px;
            font-size: 0.9em;
        }
        pre {
            background-color: var(--code-bg-color);
            color: var(--code-text-color);
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
        }
        pre code {
            background-color: transparent;
            border: none;
            color: inherit;
            padding: 0;
            font-size: inherit;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            font-size: 0.95em;
        }
        th, td {
            text-align: left;
            padding: 12px;
            border: 1px solid var(--border-color);
        }
        th {
            background-color: var(--table-header-bg);
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: var(--secondary-color);
        }
        .note {
            background-color: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        footer {
            text-align: center;
            padding: 30px;
            font-size: 0.9em;
            color: #7f8c8d;
        }
        ::selection {
            background-color: #007bff;
            color: #ffffff;
        }
    </style>
</head>
<body>

    <header>
        <h1>æ°—è±¡åº åœŸç ‚ç½å®³è­¦æˆ’æƒ…å ± ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</h1>
    </header>

    <main class="container">
        <section id="overview">
            <h2>1. æ¦‚è¦</h2>
            <p>
                ã“ã®APIã¯ã€æ°—è±¡åºãŒç™ºè¡¨ã™ã‚‹æœ€æ–°ã®**åœŸç ‚ç½å®³è­¦æˆ’æƒ…å ± (<code>VXWW50</code>)** ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§æä¾›ã™ã‚‹WebSocketã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚
            </p>
            <p>
                ã‚µãƒ¼ãƒãƒ¼å´ã§å®šæœŸçš„ã«æ°—è±¡åºã®æƒ…å ±ã‚’ãƒãƒ¼ãƒªãƒ³ã‚°ã—ã€å†…å®¹ã«æ›´æ–°ãŒã‚ã£ãŸå ´åˆã«ã®ã¿ã€æ¥ç¶šã—ã¦ã„ã‚‹å…¨ã¦ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«å¯¾ã—ã¦æ–°ã—ã„æƒ…å ±ã‚’JSONå½¢å¼ã§ãƒ—ãƒƒã‚·ãƒ¥ï¼ˆãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆï¼‰ã—ã¾ã™ã€‚
            </p>
        </section>

        <section id="connection">
            <h2>2. æ¥ç¶šæƒ…å ±</h2>
            <p>WebSocketãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ç”¨ã—ã¦ä»¥ä¸‹ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«æ¥ç¶šã—ã¦ãã ã•ã„ã€‚</p>
            <ul>
                <li><strong>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆURL:</strong> <code>ws://jma.ikunocam.net/websocket</code></li>
            </ul>
        </section>

        <section id="flow">
            <h2>3. é€šä¿¡ãƒ•ãƒ­ãƒ¼</h2>
            <p>
                é€šä¿¡ã¯ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¸ã®ä¸€æ–¹å‘ã§ã™ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯æ¥ç¶šå¾Œã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å¾…ã¤ã ã‘ã§ã€ä½•ã‹ã‚’é€ä¿¡ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
            </p>
            <ol>
                <li>ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒWebSocketã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«æ¥ç¶šã—ã¾ã™ã€‚</li>
                <li>ã‚µãƒ¼ãƒãƒ¼ã¯æ¥ç¶šã‚’å—ã‘å…¥ã‚Œã¾ã™ã€‚</li>
                <li>ã‚µãƒ¼ãƒãƒ¼å´ã§æ°—è±¡åºã®æƒ…å ±ã«æ›´æ–°ãŒæ¤œçŸ¥ã•ã‚Œã‚‹ã¨ã€ã‚µãƒ¼ãƒãƒ¼ã¯æ¥ç¶šä¸­ã®å…¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«æœ€æ–°ã®æƒ…å ±ã‚’JSONå½¢å¼ã§é€ä¿¡ã—ã¾ã™ã€‚</li>
                <li>æƒ…å ±ã«æ›´æ–°ãŒãªã„å ´åˆã€ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯é€ä¿¡ã•ã‚Œã¾ã›ã‚“ã€‚</li>
            </ol>
        </section>

        <section id="data-format">
            <h2>4. ãƒ‡ãƒ¼ã‚¿å½¢å¼</h2>
            <p>ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰é€ä¿¡ã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã¯ã€UTF-8ã§ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸ**JSONæ–‡å­—åˆ—**ã§ã™ã€‚</p>

            <h3>ã‚µãƒ³ãƒ—ãƒ«ãƒ¬ã‚¹ãƒãƒ³ã‚¹</h3>
            <pre><code>{
    "control": {
        "title": "åœŸç ‚ç½å®³è­¦æˆ’æƒ…å ±",
        "publishingOffice": "çŸ³å·çœŒ é‡‘æ²¢åœ°æ–¹æ°—è±¡å°",
        "xmlDateTime": "2025-08-10T06:20:41Z"
    },
    "head": {
        "title": "çŸ³å·çœŒåœŸç ‚ç½å®³è­¦æˆ’æƒ…å ±",
        "reportDateTime": "2025-08-10T15:20:00+09:00",
        "infoType": "ç™ºè¡¨",
        "headlineText": "ã€ˆæ¦‚æ³ã€‰ é™ã‚Šç¶šãå¤§é›¨ã®ãŸã‚ã€è­¦æˆ’å¯¾è±¡åœ°åŸŸã§ã¯åœŸç ‚ç½å®³ã®å±é™ºåº¦ãŒé«˜ã¾ã£ã¦ã„ã¾ã™ã€‚ ã€ˆã¨ã‚‹ã¹ãæªç½®ã€‰ ã€€é¿é›£ãŒå¿…è¦ã¨ãªã‚‹å±é™ºãªçŠ¶æ³ã¨ãªã£ã¦ã„ã¾ã™ã€è­¦æˆ’ãƒ¬ãƒ™ãƒ«ï¼”ç›¸å½“æƒ…å ±ï¼»åœŸç ‚ç½å®³ï¼½ã€‘ã€‚ ã€€å´–ã®è¿‘ããªã©åœŸç ‚ç½å®³ã®ç™ºç”Ÿã—ã‚„ã™ã„åœ°åŒºã«ãŠä½ã¾ã„ã®æ–¹ã¯ã€æ—©ã‚ã®é¿é›£ã‚’å¿ƒãŒã‘ã‚‹ã¨ã¨ã‚‚ã«ã€å¸‚ç”ºã‹ã‚‰ç™ºè¡¨ã•ã‚Œã‚‹é¿é›£æŒ‡ç¤ºç­‰ã®æƒ…å ±ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚",
        "alertSummary": [
            {
                "condition": "ç™ºè¡¨",
                "areas": [
                    { "name": "è¼ªå³¶å¸‚", "code": "1720400" }
                ]
            }
        ]
    },
    "body": {
        "targetPrefecture": {
            "name": "çŸ³å·çœŒ",
            "code": "170000"
        },
        "warnings": [
            {
                "area": { "name": "è¼ªå³¶å¸‚", "code": "1720400" },
                "alertLevel": { "name": "è­¦æˆ’", "code": "3", "status": "ç™ºè¡¨" }
            }
        ],
        "contactInfo": {
            "prefecture": { "name": "çŸ³å·çœŒ", "phone": "076-225-1751ï¼ˆçŸ³å·çœŒåœŸæœ¨éƒ¨ç ‚é˜²èª²ï¼‰" },
            "jma": { "name": "é‡‘æ²¢åœ°æ–¹æ°—è±¡å°", "phone": "03-5422-1018ï¼ˆæ°—è±¡åºå¤§æ°—æµ·æ´‹éƒ¨äºˆå ±èª²ï¼‰" }
        }
    }
}</code></pre>

            <h3>ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è©³ç´°</h3>
            <h4>ãƒ«ãƒ¼ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</h4>
            <table>
                <thead>
                    <tr><th>ã‚­ãƒ¼</th><th>ãƒ‡ãƒ¼ã‚¿å‹</th><th>èª¬æ˜</th></tr>
                </thead>
                <tbody>
                    <tr><td><code>control</code></td><td>Object</td><td>XMLãƒ•ã‚¡ã‚¤ãƒ«ã®ç®¡ç†æƒ…å ±ã§ã™ã€‚</td></tr>
                    <tr><td><code>head</code></td><td>Object</td><td>æƒ…å ±ã®ãƒ˜ãƒƒãƒ€ãƒ¼éƒ¨ã€‚ã‚¿ã‚¤ãƒˆãƒ«ã‚„ç™ºè¡¨æ™‚åˆ»ã€æ¦‚è¦ãªã©ãŒå«ã¾ã‚Œã¾ã™ã€‚</td></tr>
                    <tr><td><code>body</code></td><td>Object</td><td>æƒ…å ±ã®æœ¬ä½“ã€‚å¯¾è±¡åœ°åŸŸã‚„å„å¸‚ç”ºæ‘ã”ã¨ã®è©³ç´°ãªè­¦æˆ’æƒ…å ±ãŒå«ã¾ã‚Œã¾ã™ã€‚</td></tr>
                </tbody>
            </table>

            <h4><code>head</code> ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</h4>
            <table>
                <thead>
                    <tr><th>ã‚­ãƒ¼</th><th>ãƒ‡ãƒ¼ã‚¿å‹</th><th>èª¬æ˜</th></tr>
                </thead>
                <tbody>
                    <tr><td><code>head.title</code></td><td>String</td><td>æƒ…å ±ã®æ­£å¼åç§°ï¼ˆä¾‹: "çŸ³å·çœŒåœŸç ‚ç½å®³è­¦æˆ’æƒ…å ±"ï¼‰ã€‚</td></tr>
                    <tr><td><code>head.reportDateTime</code></td><td>String (ISO 8601)</td><td>æƒ…å ±ç™ºè¡¨æ™‚åˆ»ã€‚</td></tr>
                    <tr><td><code>head.infoType</code></td><td>String</td><td>æƒ…å ±ã®ç¨®é¡ã€‚ã€Œç™ºè¡¨ã€ã€Œæ›´æ–°ã€ã€Œè¨‚æ­£ã€ãªã©ã€‚</td></tr>
                    <tr><td><code>head.headlineText</code></td><td>String</td><td>æƒ…å ±ã®æ¦‚æ³ã‚’ç¤ºã™ãƒ†ã‚­ã‚¹ãƒˆã€‚</td></tr>
                    <tr><td><code>head.alertSummary</code></td><td>Array</td><td><strong>è­¦æˆ’ä¸­ã®åœ°åŸŸã®ã¿</strong>ã‚’ã¾ã¨ã‚ãŸè¦ç´„æƒ…å ±ã€‚</td></tr>
                </tbody>
            </table>

            <h4><code>body</code> ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</h4>
            <table>
                <thead>
                    <tr><th>ã‚­ãƒ¼</th><th>ãƒ‡ãƒ¼ã‚¿å‹</th><th>èª¬æ˜</th></tr>
                </thead>
                <tbody>
                    <tr><td><code>body.targetPrefecture</code></td><td>Object</td><td>å¯¾è±¡ã¨ãªã£ã¦ã„ã‚‹éƒ½é“åºœçœŒã®æƒ…å ±ã€‚</td></tr>
                    <tr><td><code>body.warnings</code></td><td>Array</td><td>å¯¾è±¡éƒ½é“åºœçœŒå†…ã®<strong>å…¨å¸‚ç”ºæ‘</strong>ã®è­¦æˆ’ãƒ¬ãƒ™ãƒ«æƒ…å ±ã‚’å«ã‚€é…åˆ—ã€‚</td></tr>
                    <tr><td><code>body.contactInfo</code></td><td>Object</td><td>éƒ½é“åºœçœŒã¨æ°—è±¡å°ã®é€£çµ¡å…ˆæƒ…å ±ã€‚</td></tr>
                </tbody>
            </table>
             <div class="note">
                <strong>ğŸ’¡ ç”¨é€”ã«ã‚ˆã‚‹ä½¿ã„åˆ†ã‘:</strong>
                <ul>
                    <li><strong>è­¦æˆ’ä¸­ã®åœ°åŸŸã ã‘</strong>ã‚’çŸ¥ã‚ŠãŸã„å ´åˆã¯ã€è»½é‡ãª <code>head.alertSummary</code> ã‚’åˆ©ç”¨ã™ã‚‹ã®ãŒåŠ¹ç‡çš„ã§ã™ã€‚</li>
                    <li><strong>å…¨åœ°åŸŸã®çŠ¶æ³ï¼ˆè­¦æˆ’ãƒ»è§£é™¤å«ã‚€ï¼‰</strong>ã‚’ãƒãƒƒãƒ—è¡¨ç¤ºã™ã‚‹ãªã©ã€ç¶²ç¾…çš„ãªæƒ…å ±ãŒå¿…è¦ãªå ´åˆã¯ <code>body.warnings</code> ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚</li>
                </ul>
            </div>
        </section>

        <section id="example">
            <h2>5. å®Ÿè£…ä¾‹ (JavaScript)</h2>
            <p>ä»¥ä¸‹ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã§ã“ã®WebSocket APIã«æ¥ç¶šã—ã€å—ä¿¡ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã™ã‚‹ç°¡å˜ãªJavaScriptã®ã‚³ãƒ¼ãƒ‰ä¾‹ã§ã™ã€‚</p>
            <pre><code>// WebSocketã‚µãƒ¼ãƒãƒ¼ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
const WEBSOCKET_URI = 'ws://jma.ikunocam.net/websocket';

console.log(`Connecting to ${WEBSOCKET_URI}...`);
const socket = new WebSocket(WEBSOCKET_URI);

// æ¥ç¶šæˆåŠŸæ™‚ã®ã‚¤ãƒ™ãƒ³ãƒˆ
socket.onopen = (event) => {
    console.log("âœ… WebSocket connection established.");
};

// ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å—ä¿¡æ™‚ã®ã‚¤ãƒ™ãƒ³ãƒˆ
socket.onmessage = (event) => {
    try {
        // å—ä¿¡ã—ãŸãƒ‡ãƒ¼ã‚¿ã¯JSONæ–‡å­—åˆ—ãªã®ã§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ãƒ‘ãƒ¼ã‚¹ã™ã‚‹
        const jmaData = JSON.parse(event.data);
        
        console.log("ğŸ“¬ New data received:", jmaData);
        
        // ã“ã“ã§å—ä¿¡ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦ç”»é¢ã‚’æ›´æ–°ã™ã‚‹ãªã©ã®å‡¦ç†ã‚’è¡Œã†
        // ä¾‹: è­¦æˆ’ä¸­ã®åœ°åŸŸåã‚’è¡¨ç¤º
        if (jmaData.head && jmaData.head.alertSummary.length > 0) {
            console.log("ç¾åœ¨è­¦æˆ’ä¸­ã®åœ°åŸŸ:");
            jmaData.head.alertSummary.forEach(summary => {
                summary.areas.forEach(area => {
                    console.log(`- ${area.name} (${summary.condition})`);
                });
            });
        } else {
            console.log("ç¾åœ¨ã€è­¦æˆ’ä¸­ã®åœ°åŸŸã¯ã‚ã‚Šã¾ã›ã‚“ã€‚");
        }

    } catch (e) {
        console.error("Error parsing received data:", e);
    }
};

// æ¥ç¶šã‚¨ãƒ©ãƒ¼æ™‚ã®ã‚¤ãƒ™ãƒ³ãƒˆ
socket.onerror = (error) => {
    console.error("WebSocket Error:", error);
};

// æ¥ç¶šåˆ‡æ–­æ™‚ã®ã‚¤ãƒ™ãƒ³ãƒˆ
socket.onclose = (event) => {
    if (event.wasClean) {
        console.log(`Connection closed cleanly, code=${event.code} reason=${event.reason}`);
    } else {
        console.error('Connection died');
    }
};
</code></pre>
        </section>

    </main>

    <footer>
        <p>JMA Real-time Information API</p>
    </footer>

</body>
</html>